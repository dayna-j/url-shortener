<html>

<head>
	<link rel="stylesheet" type="text/css" href="public/main.css">
	<!-- <script src='public/tests.js'></script> -->
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
	 crossorigin="anonymous"></script>
	<link href="https://fonts.googleapis.com/css?family=Julius+Sans+One" rel="stylesheet">
	<title></title>
</head>

<body>
	<div id='body-wrapper'>
		<header>
			<!-- <p class = 'slashed'>URL SHORTENER</p> -->
		</header>
		<div id='title-container'>

			<!-- <h1 class = 'slashed'>URL SHORTENER</h1> -->
		</div>
		<div id='form-container'>
			<form method=''>
				<input id='textBox' type='text' placeholder='Enter url to shorten'>
				<!-- <input id='submitButton' type='submit'></input>  -->
				<button id='submitButton'>Submit</button>
			</form>
		</div>
	</div>
	<footer>
		<p>By Dayna Blackwell</p>
	</footer>
	<script>
	const log = msg => console.log(msg);
  const form = document.getElementsByTagName('form')[0];
  const button = document.getElementById('submitButton');
  const textBox = document.getElementById('textBox');

  // form.addEventListener('submit', (event) => {
  //   let url = encodeURIComponent(textBox.value);
  //   $.post('/new/:url', url, (err) => {
  //          console.log('/new/:' + url)
  //          if(err) console.log(err);
  //        })
  // })

  button.addEventListener('click', (event) => {
    if(!textBox.value) {return null;}
    let url = textBox.value;

    let postObj = {
      method: 'post',
      url: url
    }
    
    // fetch('/new/url', postObj).then(resp=>resp.json()).then(data=>log(data))
    //   .catch(err=>log(err));

    // fetch('/new/'+url,postObj)
    //   .catch(err=>log(err));
    
    $.post('/new/:url', postObj, (err)=>{
      if (err) throw err;
      }).done( (data) => {
        textBox.value = data.url;
        log(data.url);
      });

  })
	</script>
</body>

</html>